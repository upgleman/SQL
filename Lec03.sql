-- 03 SQL과 함수
-- [실습1] 데이터의 숫자 세어보기 - COUNT 1
-- 도서관의 전체 책의 수와 회원 수를 조회해 봅시다.

-- 하지만 SELECT를 통해 전체를 출력하고 세어보는 것은 위험합니다. 특히 개수가 많다면 중간에 실수할 가능성이 높습니다.

-- 따라서 앞서 배운 COUNT 함수를 이용해 조회하도록 합시다.


-- 지시사항
-- book 테이블을 COUNT함수와 *을 이용해 조회해 봅시다.
-- user 테이블을 COUNT함수와 *을 이용해 조회해 봅시다.

DESC book;
DESC user;

select * from book;
select * from user;

-- 아래에 book테이블의 자료의 수와 user테이블의 자료의 수를 차례대로 조회해 봅시다.
select count(*) from book;

select count(*) from user;
+---------------+-------------+------+-----+---------+-------+
| Field         | Type        | Null | Key | Default | Extra |
+---------------+-------------+------+-----+---------+-------+
| id            | int(11)     | NO   | PRI | NULL    |       |
| title         | varchar(64) | NO   |     | NULL    |       |
| author        | varchar(64) | YES  |     | NULL    |       |
| publisher     | varchar(32) | YES  |     | NULL    |       |
| date_received | date        | YES  |     | NULL    |       |
+---------------+-------------+------+-----+---------+-------+
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| id      | int(11)     | NO   | PRI | NULL    |       |
| name    | varchar(16) | NO   |     | NULL    |       |
| email   | varchar(32) | YES  |     | NULL    |       |
| phone   | varchar(16) | YES  |     | NULL    |       |
| address | text        | YES  |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+
+------+------------------------------------------+------------------------------+-----------------------+---------------+
| id   | title                                    | author                       | publisher             | date_received |
+------+------------------------------------------+------------------------------+-----------------------+---------------+
| 1000 | Romeo and Juliet                         | William Shakespeare          | NULL                  | 2012-04-01    |
| 1001 | Don Quixote                              | Miguel de Cervantes Saavedra | NULL                  | 2015-03-31    |
| 1002 | The Little Prince                        | Antoine de Saint-Exupery     | NULL                  | 2018-12-21    |
| 1003 | Harry Potter and the Philosopher's Stone | Joanne Kathleen Rowling      | Bloomsbury Publishing | 2017-06-26    |
| 1004 | The Lord of the Rings                    | John Ronald Reuel Tolkien    | Allen & Unwin         | 2014-07-29    |
+------+------------------------------------------+------------------------------+-----------------------+---------------+
+------+-------------+-----------------------+---------------+------------------+
| id   | name        | email                 | phone         | address          |
+------+-------------+-----------------------+---------------+------------------+
| 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
+------+-------------+-----------------------+---------------+------------------+

+----------+
| count(*) |
+----------+
|        5 |
+----------+
+----------+
| count(*) |
+----------+
|        4 |
+----------+
'
-- [실습2] 데이터의 숫자 세어보기 - COUNT 2
-- 직원의 전체 수를 검색해봅시다.

-- 하지만 SELECT를 통해 전체를 출력하고 세어보는 것은 위험합니다. 특히 개수가 많다면 중간에 실수할 가능성이 높습니다.

-- 따라서 앞서 배운 COUNT 함수를 이용해 검색하도록 합시다.


-- 지시사항
-- employees 테이블을 COUNT함수와 *을 이용해 검색해봅시다.

DESC employees;
select * from employees;

-- employees테이블의 자료의 수를 조회해 봅시다.
select count(*) from employees;

+-------------+---------------+------+-----+---------+-------+
| Field       | Type          | Null | Key | Default | Extra |
+-------------+---------------+------+-----+---------+-------+
| emp_no      | int(11)       | NO   | PRI | NULL    |       |
| birth_date  | date          | NO   |     | NULL    |       |
| first_name  | varchar(14)   | NO   |     | NULL    |       |
| last_name   | varchar(16)   | NO   |     | NULL    |       |
| gender      | enum('M','F') | NO   |     | NULL    |       |
| hire_date   | date          | NO   |     | NULL    |       |
| superior_no | int(11)       | YES  | MUL | NULL    |       |
+-------------+---------------+------+-----+---------+-------+
+--------+------------+-------------+-----------------+--------+------------+-------------+
| emp_no | birth_date | first_name  | last_name       | gender | hire_date  | superior_no |
+--------+------------+-------------+-----------------+--------+------------+-------------+
|  10012 | 1960-10-04 | Patricio    | Bridgland       | M      | 1992-12-18 |        NULL |
|  10015 | 1959-08-19 | Guoxiang    | Nooteboom       | M      | 1987-07-02 |        NULL |
|  10019 | 1953-01-23 | Lillian     | Haddadi         | M      | 1999-04-30 |       10015 |
|  10033 | 1959-12-03 | Parto       | Bamford         | M      | 1986-08-28 |        NULL |
|  10037 | 1957-05-23 | Tzvetan     | Zielinski       | F      | 1989-02-10 |        NULL |
|  10088 | 1958-02-19 | Saniya      | Kalloufi        | M      | 1994-09-15 |       10202 |
|  10202 | 1964-06-02 | Bezalel     | Simmel          | F      | 1985-11-21 |        NULL |
|  10404 | 1954-05-01 | Chirstian   | Koblick         | M      | 1986-12-01 |        NULL |
|  10506 | 1953-04-20 | Anneke      | Preusig         | F      | 1989-06-02 |        NULL |
|  10511 | 1953-11-07 | Mary        | Sluis           | F      | 1990-01-22 |       10202 |
|  10516 | 1961-05-02 | Kazuhito    | Cappelletti     | M      | 1995-01-27 |        NULL |
|  10610 | 1963-06-01 | Duangkaew   | Piveteau        | F      | 1989-08-24 |        NULL |
|  10620 | 1952-12-24 | Mayuko      | Warwick         | M      | 1991-01-26 |       10015 |
|  11001 | 1953-09-02 | Georgi      | Facello         | M      | 1986-06-26 |        NULL |
|  11267 | 1958-11-21 | Seshu       | Bazelow         | F      | 1993-06-16 |       11366 |
|  11366 | 1964-01-04 | Naftali     | Koshino         | F      | 1986-05-03 |        NULL |
|  11449 | 1953-12-02 | Shridhar    | Pleszkun        | M      | 1998-08-23 |        NULL |
|  11458 | 1962-03-18 | Nidapan     | Ginneken        | M      | 1993-08-29 |        NULL |
|  11460 | 1955-11-19 | Mana        | Maraist         | M      | 1992-03-14 |       11765 |
|  11467 | 1955-05-15 | Fox         | Narahari        | M      | 1985-09-10 |        NULL |
|  11468 | 1955-12-02 | Navin       | Maksimenko      | F      | 1996-03-19 |       11366 |
|  11474 | 1953-04-17 | Gennady     | Akazan          | M      | 1990-07-26 |        NULL |
|  11480 | 1960-09-13 | Masoud      | Itschner        | F      | 1990-03-13 |        NULL |
|  11563 | 1960-08-06 | Rajmohan    | Kamber          | F      | 1992-05-17 |       10015 |
|  11664 | 1962-10-22 | Boutros     | Simkin          | M      | 1992-05-30 |       11765 |
|  11765 | 1956-08-21 | Tomoyuki    | Porenta         | M      | 1985-07-14 |        NULL |
|  12000 | 1957-11-09 | Claudi      | Angelov         | M      | 1989-01-12 |        NULL |
|  12001 | 1960-11-06 | Ulf         | Hofstetter      | F      | 1989-03-10 |        NULL |
|  12002 | 1959-09-17 | Seongbae    | Kavraki         | M      | 1994-10-14 |       12606 |
|  12003 | 1961-04-15 | Luise       | McFarlan        | M      | 1992-11-20 |       12606 |
|  12007 | 1952-06-18 | Marko       | Dehkordi        | M      | 1989-05-17 |       12510 |
|  12014 | 1956-02-12 | Berni       | Genin           | M      | 1987-03-11 |        NULL |
|  12034 | 1962-02-11 | Lucien      | Schlenzig       | F      | 1986-10-13 |        NULL |
|  12461 | 1955-04-18 | Kish        | Cronau          | M      | 1986-08-19 |        NULL |
|  12510 | 1956-09-26 | Otmar       | Thebaut         | F      | 1988-11-06 |        NULL |
|  12606 | 1963-08-09 | Remco       | Erol            | M      | 1989-12-27 |        NULL |
|  12609 | 1963-09-26 | Sariel      | Stifter         | M      | 1994-11-28 |       12606 |
|  12708 | 1953-09-13 | Frederique  | Zykh            | F      | 1991-08-07 |       12510 |
|  13013 | 1963-06-07 | Eberhardt   | Terkki          | M      | 1985-10-20 |        NULL |
|  13462 | 1959-01-28 | Chikara     | Maginnis        | M      | 1990-04-27 |       11765 |
|  13473 | 1957-06-27 | Jiakeng     | Eugenio         | M      | 1986-11-19 |        NULL |
|  15005 | 1958-07-27 | Shir        | DuCasse         | M      | 1993-03-30 |        NULL |
|  15476 | 1954-06-20 | Manton      | Yoshizawa       | F      | 1994-01-15 |        NULL |
|  15495 | 1955-01-21 | Kyoichi     | Maliniak        | M      | 1989-09-12 |        NULL |
|  16469 | 1952-12-01 | Guttorm     | Giaccio         | M      | 1988-05-23 |        NULL |
|  16475 | 1957-04-25 | Dekang      | Siegrist        | F      | 1997-08-04 |        NULL |
|  17018 | 1954-06-19 | Kazuhide    | Peha            | F      | 1987-04-03 |        NULL |
|  18470 | 1962-10-11 | Khalid      | Michaels        | M      | 1991-11-26 |       16469 |
|  18472 | 1961-04-18 | Constantino | Ghandeharizadeh | M      | 1990-04-30 |        NULL |
|  18817 | 1958-07-06 | Cristinel   | Bouloucos       | F      | 1993-08-03 |       10015 |
|  19009 | 1952-04-19 | Sumant      | Peac            | F      | 1985-02-18 |        NULL |
|  19471 | 1961-03-24 | Subhada     | Champarnaud     | F      | 1987-04-26 |        NULL |
+--------+------------+-------------+-----------------+--------+------------+-------------+
+----------+
| count(*) |
+----------+
|       52 |
+----------+

-- [실습3] 데이터에서 상단 값만 출력하기 - LIMIT 1
-- 엘리스 도서관에 책이 몇 권 더 추가로 들어왔습니다.

-- 이제 도서관에는 책을 한 번에 조회하면 알아볼 수 없을 정도로 많아졌습니다.

-- 혼란스러운 엘리스를 위해 SELECT문 뒤에 LIMIT를 덧붙여 책 정보 5개만을 조회해보세요!
-- 지시사항
-- book테이블에서 LIMIT를 덧붙여 책 정보 5개만을 조회해보세요.
-- 출력할 때는 모든 컬럼을 조회하도록 합시다.

DESC book;
select * from book;

-- book테이블의 모든 컬럼을 조회해 봅시다. 단 5권만 잘라서 출력해야 합니다.

select * from book limit 5;

+---------------+-------------+------+-----+---------+-------+
| Field         | Type        | Null | Key | Default | Extra |
+---------------+-------------+------+-----+---------+-------+
| id            | varchar(32) | NO   | PRI | NULL    |       |
| title         | varchar(64) | NO   |     | NULL    |       |
| author        | varchar(16) | YES  |     | NULL    |       |
| publisher     | varchar(32) | YES  |     | NULL    |       |
| date_received | date        | YES  |     | NULL    |       |
+---------------+-------------+------+-----+---------+-------+
+------+------------------------------------------+------------------+-------------------------+---------------+
| id   | title                                    | author           | publisher               | date_received |
+------+------------------------------------------+------------------+-------------------------+---------------+
| 1000 | Romeo and Juliet                         | William Shakespe | NULL                    | 2012-04-01    |
| 1001 | Don Quixote                              | Miguel de Cervan | NULL                    | 2015-03-31    |
| 1002 | The Little Prince                        | Antoine de Saint | NULL                    | 2018-12-21    |
| 1003 | Harry Potter and the Philosopher's Stone | Joanne Kathleen  | Bloomsbury Publishing   | 2017-06-26    |
| 1004 | The Lord of the Rings                    | John Ronald Reue | Allen & Unwin           | 2014-07-29    |
| 1006 | Alice's Adventures in Wonderland         | Lewis Carroll    | Macmillan               | 2015-11-26    |
| 1007 | The Old Man and the Sea                  | Ernest Miller He | Charles Scribner's Sons | 2014-11-02    |
| 1008 | The Great Gatsby                         | Francis Scott Ke | NULL                    | 2019-01-12    |
| 1009 | Harry Potter and the Deathly Hallows     | Joanne Kathleen  | Bloomsbury Publishing   | 2017-07-21    |
+------+------------------------------------------+------------------+-------------------------+---------------+

+------+------------------------------------------+------------------+-----------------------+---------------+
| id   | title                                    | author           | publisher             | date_received |
+------+------------------------------------------+------------------+-----------------------+---------------+
| 1000 | Romeo and Juliet                         | William Shakespe | NULL                  | 2012-04-01    |
| 1001 | Don Quixote                              | Miguel de Cervan | NULL                  | 2015-03-31    |
| 1002 | The Little Prince                        | Antoine de Saint | NULL                  | 2018-12-21    |
| 1003 | Harry Potter and the Philosopher's Stone | Joanne Kathleen  | Bloomsbury Publishing | 2017-06-26    |
| 1004 | The Lord of the Rings                    | John Ronald Reue | Allen & Unwin         | 2014-07-29    |
+------+------------------------------------------+------------------+-----------------------+---------------+

-- [실습4] 데이터에서 상단 값만 출력하기 - LIMIT 2
-- salaries 테이블에는 직원들의 연도별 연봉이 들어있습니다.

-- 회사가 오래 유지되면서 연봉을 한 번에 조회하면 알아볼 수 없을 정도로 많아졌습니다.

-- 혼란을 방지하기 위해 SELECT문 뒤에 LIMIT를 덧붙여 연봉 정보 5개만을 검색해보세요!


-- 지시사항
-- salaries 테이블에서 SELECT문 뒤에 LIMIT를 덧붙여 연봉 정보 5개만을 검색해보세요.
-- 검색할 때는 모든 컬럼을 검색하도록 합니다.

DESC salaries;
select * from salaries;

-- salaries테이블의 모든 컬럼을 조회해 봅시다. 단 5개만 잘라서 출력해야 합니다.

select * from salaries limit 5;

+-----------+---------+------+-----+---------+-------+
| Field     | Type    | Null | Key | Default | Extra |
+-----------+---------+------+-----+---------+-------+
| emp_no    | int(11) | NO   |     | NULL    |       |
| salary    | int(11) | NO   |     | NULL    |       |
| from_date | date    | NO   |     | NULL    |       |
| to_date   | date    | NO   |     | NULL    |       |
+-----------+---------+------+-----+---------+-------+
+--------+--------+------------+------------+
| emp_no | salary | from_date  | to_date    |
+--------+--------+------------+------------+
|  10001 |  62102 | 1987-06-26 | 1988-06-25 |
|  10001 |  66074 | 1988-06-25 | 1989-06-25 |
|  10001 |  66596 | 1989-06-25 | 1990-06-25 |
|  10001 |  66961 | 1990-06-25 | 1991-06-25 |
|  10001 |  71046 | 1991-06-25 | 1992-06-24 |
|  10001 |  74333 | 1992-06-24 | 1993-06-24 |
|  10001 |  76884 | 1995-06-24 | 1996-06-23 |
|  10001 |  80013 | 1996-06-23 | 1997-06-23 |
|  10001 |  81025 | 1997-06-23 | 1998-06-23 |
|  10001 |  81097 | 1998-06-23 | 1999-06-23 |
|  10001 |  84917 | 1999-06-23 | 2000-06-22 |
|  10002 |  65828 | 1996-08-03 | 1997-08-03 |
|  10002 |  65909 | 1997-08-03 | 1998-08-03 |
|  10002 |  67534 | 1998-08-03 | 1999-08-03 |
|  10002 |  69366 | 1999-08-03 | 2000-08-02 |
|  10002 |  71963 | 2000-08-02 | 2001-08-02 |
|  10002 |  72527 | 2001-08-02 | 9999-01-01 |
|  10003 |  40006 | 1995-12-03 | 1996-12-02 |
|  10003 |  43616 | 1996-12-02 | 1997-12-02 |
|  10003 |  43311 | 2001-12-01 | 9999-01-01 |
|  10004 |  40054 | 1986-12-01 | 1987-12-01 |
|  10004 |  42283 | 1987-12-01 | 1988-11-30 |
|  10004 |  42542 | 1988-11-30 | 1989-11-30 |
|  10004 |  46065 | 1989-11-30 | 1990-11-30 |
|  10004 |  58326 | 1994-11-29 | 1995-11-29 |
|  10004 |  60770 | 1995-11-29 | 1996-11-28 |
|  10004 |  62566 | 1996-11-28 | 1997-11-28 |
|  10004 |  64340 | 1997-11-28 | 1998-11-28 |
|  10004 |  67096 | 1998-11-28 | 1999-11-28 |
|  10004 |  69722 | 1999-11-28 | 2000-11-27 |
|  10004 |  70698 | 2000-11-27 | 2001-11-27 |
|  10004 |  74057 | 2001-11-27 | 9999-01-01 |
|  10005 |  78228 | 1989-09-12 | 1990-09-12 |
|  10005 |  82621 | 1990-09-12 | 1991-09-12 |
|  10005 |  88063 | 1996-09-10 | 1997-09-10 |
|  10005 |  89724 | 1997-09-10 | 1998-09-10 |
|  10005 |  90392 | 1998-09-10 | 1999-09-10 |
|  10005 |  90531 | 1999-09-10 | 2000-09-09 |
|  10005 |  91453 | 2000-09-09 | 2001-09-09 |
|  10005 |  94692 | 2001-09-09 | 9999-01-01 |
|  10006 |  40000 | 1990-08-05 | 1991-08-05 |
|  10006 |  42085 | 1991-08-05 | 1992-08-04 |
|  10006 |  42629 | 1992-08-04 | 1993-08-04 |
|  10006 |  45844 | 1993-08-04 | 1994-08-04 |
|  10006 |  47518 | 1994-08-04 | 1995-08-04 |
|  10006 |  47917 | 1995-08-04 | 1996-08-03 |
|  10006 |  52255 | 1996-08-03 | 1997-08-03 |
|  10006 |  53747 | 1997-08-03 | 1998-08-03 |
|  10007 |  62745 | 1991-02-10 | 1992-02-10 |
|  10007 |  63475 | 1992-02-10 | 1993-02-09 |
|  10007 |  63208 | 1993-02-09 | 1994-02-09 |
|  10007 |  64563 | 1994-02-09 | 1995-02-09 |
+--------+--------+------------+------------+

+--------+--------+------------+------------+
| emp_no | salary | from_date  | to_date    |
+--------+--------+------------+------------+
|  10001 |  62102 | 1987-06-26 | 1988-06-25 |
|  10001 |  66074 | 1988-06-25 | 1989-06-25 |
|  10001 |  66596 | 1989-06-25 | 1990-06-25 |
|  10001 |  66961 | 1990-06-25 | 1991-06-25 |
|  10001 |  71046 | 1991-06-25 | 1992-06-24 |
+--------+--------+------------+------------+

-- [실습5] 데이터들의 합 구하기 - SUM
-- salaries 테이블에서 지금까지 지급되었던 연봉액(salary)에 대한 합을 계산하려고 합니다.

-- SUM함수를 이용해서 구해보세요.


-- 지시사항
-- salaries 테이블에서 salary의 합을 구해서 검색해봅시다.

DESC salaries;
select * from salaries;

-- salary테이블의 연봉의 합을 구해봅시다.

select sum(salary) from salaries;

+-----------+---------+------+-----+---------+-------+
| Field     | Type    | Null | Key | Default | Extra |
+-----------+---------+------+-----+---------+-------+
| emp_no    | int(11) | NO   |     | NULL    |       |
| salary    | int(11) | NO   |     | NULL    |       |
| from_date | date    | NO   |     | NULL    |       |
| to_date   | date    | NO   |     | NULL    |       |
+-----------+---------+------+-----+---------+-------+
+--------+--------+------------+------------+
| emp_no | salary | from_date  | to_date    |
+--------+--------+------------+------------+
|  10001 |  62102 | 1987-06-26 | 1988-06-25 |
|  10001 |  66074 | 1988-06-25 | 1989-06-25 |
|  10001 |  66596 | 1989-06-25 | 1990-06-25 |
|  10001 |  66961 | 1990-06-25 | 1991-06-25 |
|  10001 |  71046 | 1991-06-25 | 1992-06-24 |
|  10001 |  74333 | 1992-06-24 | 1993-06-24 |
|  10001 |  76884 | 1995-06-24 | 1996-06-23 |
|  10001 |  80013 | 1996-06-23 | 1997-06-23 |
|  10001 |  81025 | 1997-06-23 | 1998-06-23 |
|  10001 |  81097 | 1998-06-23 | 1999-06-23 |
|  10001 |  84917 | 1999-06-23 | 2000-06-22 |
|  10002 |  65828 | 1996-08-03 | 1997-08-03 |
|  10002 |  65909 | 1997-08-03 | 1998-08-03 |
|  10002 |  67534 | 1998-08-03 | 1999-08-03 |
|  10002 |  69366 | 1999-08-03 | 2000-08-02 |
|  10002 |  71963 | 2000-08-02 | 2001-08-02 |
|  10002 |  72527 | 2001-08-02 | 9999-01-01 |
|  10003 |  40006 | 1995-12-03 | 1996-12-02 |
|  10003 |  43616 | 1996-12-02 | 1997-12-02 |
|  10003 |  43311 | 2001-12-01 | 9999-01-01 |
|  10004 |  40054 | 1986-12-01 | 1987-12-01 |
|  10004 |  42283 | 1987-12-01 | 1988-11-30 |
|  10004 |  42542 | 1988-11-30 | 1989-11-30 |
|  10004 |  46065 | 1989-11-30 | 1990-11-30 |
|  10004 |  58326 | 1994-11-29 | 1995-11-29 |
|  10004 |  60770 | 1995-11-29 | 1996-11-28 |
|  10004 |  62566 | 1996-11-28 | 1997-11-28 |
|  10004 |  64340 | 1997-11-28 | 1998-11-28 |
|  10004 |  67096 | 1998-11-28 | 1999-11-28 |
|  10004 |  69722 | 1999-11-28 | 2000-11-27 |
|  10004 |  70698 | 2000-11-27 | 2001-11-27 |
|  10004 |  74057 | 2001-11-27 | 9999-01-01 |
|  10005 |  78228 | 1989-09-12 | 1990-09-12 |
|  10005 |  82621 | 1990-09-12 | 1991-09-12 |
|  10005 |  88063 | 1996-09-10 | 1997-09-10 |
|  10005 |  89724 | 1997-09-10 | 1998-09-10 |
|  10005 |  90392 | 1998-09-10 | 1999-09-10 |
|  10005 |  90531 | 1999-09-10 | 2000-09-09 |
|  10005 |  91453 | 2000-09-09 | 2001-09-09 |
|  10005 |  94692 | 2001-09-09 | 9999-01-01 |
|  10006 |  40000 | 1990-08-05 | 1991-08-05 |
|  10006 |  42085 | 1991-08-05 | 1992-08-04 |
|  10006 |  42629 | 1992-08-04 | 1993-08-04 |
|  10006 |  45844 | 1993-08-04 | 1994-08-04 |
|  10006 |  47518 | 1994-08-04 | 1995-08-04 |
|  10006 |  47917 | 1995-08-04 | 1996-08-03 |
|  10006 |  52255 | 1996-08-03 | 1997-08-03 |
|  10006 |  53747 | 1997-08-03 | 1998-08-03 |
|  10007 |  62745 | 1991-02-10 | 1992-02-10 |
|  10007 |  63475 | 1992-02-10 | 1993-02-09 |
|  10007 |  63208 | 1993-02-09 | 1994-02-09 |
|  10007 |  64563 | 1994-02-09 | 1995-02-09 |
+--------+--------+------------+------------+
+-------------+
| sum(salary) |
+-------------+
|     3381317 |
+-------------+

-- [실습6] 데이터들의 평균 구하기 - AVG 1
-- grade 테이블 안에는 이번 중간고사에서 본 성적이 들어 있습니다.

-- 이 테이블을 이용해 과목별 평균점수를 구해봅시다.

-- 이번에도 직접 계산하는 것은 어려우니 AVG함수를 이용해 봅시다.


-- 지시사항
-- grade 테이블에서 모든 국어 점수의 평균, 모든 영어 점수의 평균, 모든 수학 점수의 평균 총 세개의 값을 구해봅시다.
-- 국어, 영어, 수학 순서로 하나의 SELECT문을 이용해 조회합니다.

DESC grade;
select * from grade;

-- 학생들의 성적의 평균을 조회합니다.
select avg(korean),avg(english),avg(math) from grade;

+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| id      | int(11)     | NO   | PRI | NULL    |       |
| name    | varchar(32) | NO   |     | NULL    |       |
| korean  | int(11)     | YES  |     | NULL    |       |
| english | int(11)     | YES  |     | NULL    |       |
| math    | int(11)     | YES  |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+
+------+----------------+--------+---------+------+
| id   | name           | korean | english | math |
+------+----------------+--------+---------+------+
| 1000 | Elice          |    100 |      80 |   60 |
| 1001 | Cheshire       |    100 |      50 |   60 |
| 1002 | Dodo           |     90 |      90 |  100 |
| 1003 | Caterpillar    |     75 |      85 |  100 |
| 1004 | Hatter         |     90 |      60 |   90 |
| 1005 | Queen of Heart |     80 |      75 |   60 |
| 1006 | Trump          |     65 |     100 |   80 |
+------+----------------+--------+---------+------+
+-------------+--------------+-----------+
| avg(korean) | avg(english) | avg(math) |
+-------------+--------------+-----------+
|     85.7143 |      77.1429 |   78.5714 |
+-------------+--------------+-----------+


-- [실습7] 데이터들의 평균 구하기 - AVG 2
-- salaries 테이블에는 지금까지 직원들에게 지급되었던 연봉액(salary)에 대한 정보가 들어 있습니다.

-- 이 테이블을 이용해 평균 연봉을 구해봅시다.

-- 이번에도 직접 계산하는 것은 어려우니 AVG 함수를 이용해 봅시다.


-- 지시사항
-- salaries 테이블에서 salary의 평균을 구해서 검색해봅시다.

DESC salaries;
select * from salaries;

-- salary테이블의 연봉의 평균을 구해봅시다.
select avg(salary) from salaries;

+-----------+---------+------+-----+---------+-------+
| Field     | Type    | Null | Key | Default | Extra |
+-----------+---------+------+-----+---------+-------+
| emp_no    | int(11) | NO   |     | NULL    |       |
| salary    | int(11) | NO   |     | NULL    |       |
| from_date | date    | NO   |     | NULL    |       |
| to_date   | date    | NO   |     | NULL    |       |
+-----------+---------+------+-----+---------+-------+
+--------+--------+------------+------------+
| emp_no | salary | from_date  | to_date    |
+--------+--------+------------+------------+
|  10001 |  62102 | 1987-06-26 | 1988-06-25 |
|  10001 |  66074 | 1988-06-25 | 1989-06-25 |
|  10001 |  66596 | 1989-06-25 | 1990-06-25 |
|  10001 |  66961 | 1990-06-25 | 1991-06-25 |
|  10001 |  71046 | 1991-06-25 | 1992-06-24 |
|  10001 |  74333 | 1992-06-24 | 1993-06-24 |
|  10001 |  76884 | 1995-06-24 | 1996-06-23 |
|  10001 |  80013 | 1996-06-23 | 1997-06-23 |
|  10001 |  81025 | 1997-06-23 | 1998-06-23 |
|  10001 |  81097 | 1998-06-23 | 1999-06-23 |
|  10001 |  84917 | 1999-06-23 | 2000-06-22 |
|  10002 |  65828 | 1996-08-03 | 1997-08-03 |
|  10002 |  65909 | 1997-08-03 | 1998-08-03 |
|  10002 |  67534 | 1998-08-03 | 1999-08-03 |
|  10002 |  69366 | 1999-08-03 | 2000-08-02 |
|  10002 |  71963 | 2000-08-02 | 2001-08-02 |
|  10002 |  72527 | 2001-08-02 | 9999-01-01 |
|  10003 |  40006 | 1995-12-03 | 1996-12-02 |
|  10003 |  43616 | 1996-12-02 | 1997-12-02 |
|  10003 |  43311 | 2001-12-01 | 9999-01-01 |
|  10004 |  40054 | 1986-12-01 | 1987-12-01 |
|  10004 |  42283 | 1987-12-01 | 1988-11-30 |
|  10004 |  42542 | 1988-11-30 | 1989-11-30 |
|  10004 |  46065 | 1989-11-30 | 1990-11-30 |
|  10004 |  58326 | 1994-11-29 | 1995-11-29 |
|  10004 |  60770 | 1995-11-29 | 1996-11-28 |
|  10004 |  62566 | 1996-11-28 | 1997-11-28 |
|  10004 |  64340 | 1997-11-28 | 1998-11-28 |
|  10004 |  67096 | 1998-11-28 | 1999-11-28 |
|  10004 |  69722 | 1999-11-28 | 2000-11-27 |
|  10004 |  70698 | 2000-11-27 | 2001-11-27 |
|  10004 |  74057 | 2001-11-27 | 9999-01-01 |
|  10005 |  78228 | 1989-09-12 | 1990-09-12 |
|  10005 |  82621 | 1990-09-12 | 1991-09-12 |
|  10005 |  88063 | 1996-09-10 | 1997-09-10 |
|  10005 |  89724 | 1997-09-10 | 1998-09-10 |
|  10005 |  90392 | 1998-09-10 | 1999-09-10 |
|  10005 |  90531 | 1999-09-10 | 2000-09-09 |
|  10005 |  91453 | 2000-09-09 | 2001-09-09 |
|  10005 |  94692 | 2001-09-09 | 9999-01-01 |
|  10006 |  40000 | 1990-08-05 | 1991-08-05 |
|  10006 |  42085 | 1991-08-05 | 1992-08-04 |
|  10006 |  42629 | 1992-08-04 | 1993-08-04 |
|  10006 |  45844 | 1993-08-04 | 1994-08-04 |
|  10006 |  47518 | 1994-08-04 | 1995-08-04 |
|  10006 |  47917 | 1995-08-04 | 1996-08-03 |
|  10006 |  52255 | 1996-08-03 | 1997-08-03 |
|  10006 |  53747 | 1997-08-03 | 1998-08-03 |
|  10007 |  62745 | 1991-02-10 | 1992-02-10 |
|  10007 |  63475 | 1992-02-10 | 1993-02-09 |
|  10007 |  63208 | 1993-02-09 | 1994-02-09 |
|  10007 |  64563 | 1994-02-09 | 1995-02-09 |
+--------+--------+------------+------------+
+-------------+
| avg(salary) |
+-------------+
|  65025.3269 |
+-------------+

-- [실습8] 데이터에서 최대값 찾기 - MAX 1
-- 이번 국어시험은 아주 어려웠습니다

-- 그래서 엘리스는 100점을 맞은 친구가 없을 거라 생각했습니다.

-- 그 생각이 맞았는지 확인하기 위해 국어시험에서 가장 높은 점수가 몇 점이었는지 조회해 봅시다.

-- SELECT문에 MAX함수를 이용해 조회하면 됩니다.


-- 지시사항
-- 국어시험에서 가장 높은 점수가 몇 점이었는지 student테이블에서 조회해보세요.

-- 학생들의 성적이 담겨있는 테이블의 구조를 조회합니다. 수정하실 필요는 없습니다.
DESC student;
select * from student;
-- 가장 높은 국어성적을 조회합니다.
select MAX(korean) from student;

+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| name    | varchar(32) | NO   | PRI | NULL    |       |
| korean  | int(11)     | YES  |     | NULL    |       |
| english | int(11)     | YES  |     | NULL    |       |
| math    | int(11)     | YES  |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+
+----------------+--------+---------+------+
| name           | korean | english | math |
+----------------+--------+---------+------+
| Caterpillar    |     75 |      85 |  100 |
| Cheshire       |    100 |      50 |   60 |
| Dodo           |     90 |      90 |  100 |
| Elice          |    100 |      80 |   60 |
| Hatter         |     90 |      60 |   90 |
| Queen of Heart |     80 |      75 |   60 |
| Trump          |     65 |     100 |   80 |
+----------------+--------+---------+------+
+-------------+
| MAX(korean) |
+-------------+
|         100 |
+-------------+

-- [실습9] 데이터에서 최대값 찾기 - MAX 2
-- 가장 많은 연봉액이 얼마인지 검색해봅시다.

-- SELECT문에 MAX함수를 이용해 검색하면 됩니다.


-- 지시사항
-- salaries테이블에서 MAX함수를 이용해 가장 많은 연봉액(salary)을 구해봅시다.

DESC salaries;
select * from salaries;
-- 가장 많은 연봉액을 구해봅시다.
select max(salary) from salaries;

+-----------+---------+------+-----+---------+-------+
| Field     | Type    | Null | Key | Default | Extra |
+-----------+---------+------+-----+---------+-------+
| emp_no    | int(11) | NO   |     | NULL    |       |
| salary    | int(11) | NO   |     | NULL    |       |
| from_date | date    | NO   |     | NULL    |       |
| to_date   | date    | NO   |     | NULL    |       |
+-----------+---------+------+-----+---------+-------+
+--------+--------+------------+------------+
| emp_no | salary | from_date  | to_date    |
+--------+--------+------------+------------+
|  10001 |  62102 | 1987-06-26 | 1988-06-25 |
|  10001 |  66074 | 1988-06-25 | 1989-06-25 |
|  10001 |  66596 | 1989-06-25 | 1990-06-25 |
|  10001 |  66961 | 1990-06-25 | 1991-06-25 |
|  10001 |  71046 | 1991-06-25 | 1992-06-24 |
|  10001 |  74333 | 1992-06-24 | 1993-06-24 |
|  10001 |  76884 | 1995-06-24 | 1996-06-23 |
|  10001 |  80013 | 1996-06-23 | 1997-06-23 |
|  10001 |  81025 | 1997-06-23 | 1998-06-23 |
|  10001 |  81097 | 1998-06-23 | 1999-06-23 |
|  10001 |  84917 | 1999-06-23 | 2000-06-22 |
|  10002 |  65828 | 1996-08-03 | 1997-08-03 |
|  10002 |  65909 | 1997-08-03 | 1998-08-03 |
|  10002 |  67534 | 1998-08-03 | 1999-08-03 |
|  10002 |  69366 | 1999-08-03 | 2000-08-02 |
|  10002 |  71963 | 2000-08-02 | 2001-08-02 |
|  10002 |  72527 | 2001-08-02 | 9999-01-01 |
|  10003 |  40006 | 1995-12-03 | 1996-12-02 |
|  10003 |  43616 | 1996-12-02 | 1997-12-02 |
|  10003 |  43311 | 2001-12-01 | 9999-01-01 |
|  10004 |  40054 | 1986-12-01 | 1987-12-01 |
|  10004 |  42283 | 1987-12-01 | 1988-11-30 |
|  10004 |  42542 | 1988-11-30 | 1989-11-30 |
|  10004 |  46065 | 1989-11-30 | 1990-11-30 |
|  10004 |  58326 | 1994-11-29 | 1995-11-29 |
|  10004 |  60770 | 1995-11-29 | 1996-11-28 |
|  10004 |  62566 | 1996-11-28 | 1997-11-28 |
|  10004 |  64340 | 1997-11-28 | 1998-11-28 |
|  10004 |  67096 | 1998-11-28 | 1999-11-28 |
|  10004 |  69722 | 1999-11-28 | 2000-11-27 |
|  10004 |  70698 | 2000-11-27 | 2001-11-27 |
|  10004 |  74057 | 2001-11-27 | 9999-01-01 |
|  10005 |  78228 | 1989-09-12 | 1990-09-12 |
|  10005 |  82621 | 1990-09-12 | 1991-09-12 |
|  10005 |  88063 | 1996-09-10 | 1997-09-10 |
|  10005 |  89724 | 1997-09-10 | 1998-09-10 |
|  10005 |  90392 | 1998-09-10 | 1999-09-10 |
|  10005 |  90531 | 1999-09-10 | 2000-09-09 |
|  10005 |  91453 | 2000-09-09 | 2001-09-09 |
|  10005 |  94692 | 2001-09-09 | 9999-01-01 |
|  10006 |  40000 | 1990-08-05 | 1991-08-05 |
|  10006 |  42085 | 1991-08-05 | 1992-08-04 |
|  10006 |  42629 | 1992-08-04 | 1993-08-04 |
|  10006 |  45844 | 1993-08-04 | 1994-08-04 |
|  10006 |  47518 | 1994-08-04 | 1995-08-04 |
|  10006 |  47917 | 1995-08-04 | 1996-08-03 |
|  10006 |  52255 | 1996-08-03 | 1997-08-03 |
|  10006 |  53747 | 1997-08-03 | 1998-08-03 |
|  10007 |  62745 | 1991-02-10 | 1992-02-10 |
|  10007 |  63475 | 1992-02-10 | 1993-02-09 |
|  10007 |  63208 | 1993-02-09 | 1994-02-09 |
|  10007 |  64563 | 1994-02-09 | 1995-02-09 |
+--------+--------+------------+------------+

+-------------+
| max(salary) |
+-------------+
|       94692 |
+-------------+

-- [실습10] 데이터에서 최소값 찾기 - MIN
-- 이번엔 반대로 가장 적은 연봉액이 얼마인지 조회해 봅시다.

-- SELECT문에 MIN함수를 이용해 검색하면 됩니다.


-- 지시사항
-- salaries테이블에서 MIN함수를 이용해 가장 적은 연봉액(salary)을 구해봅시다.

DESC salaries;
select * from salaries;
-- 가장 적은 연봉액을 구해봅시다.
select min(salary) from salaries;

+-----------+---------+------+-----+---------+-------+
| Field     | Type    | Null | Key | Default | Extra |
+-----------+---------+------+-----+---------+-------+
| emp_no    | int(11) | NO   |     | NULL    |       |
| salary    | int(11) | NO   |     | NULL    |       |
| from_date | date    | NO   |     | NULL    |       |
| to_date   | date    | NO   |     | NULL    |       |
+-----------+---------+------+-----+---------+-------+
+--------+--------+------------+------------+
| emp_no | salary | from_date  | to_date    |
+--------+--------+------------+------------+
|  10001 |  62102 | 1987-06-26 | 1988-06-25 |
|  10001 |  66074 | 1988-06-25 | 1989-06-25 |
|  10001 |  66596 | 1989-06-25 | 1990-06-25 |
|  10001 |  66961 | 1990-06-25 | 1991-06-25 |
|  10001 |  71046 | 1991-06-25 | 1992-06-24 |
|  10001 |  74333 | 1992-06-24 | 1993-06-24 |
|  10001 |  76884 | 1995-06-24 | 1996-06-23 |
|  10001 |  80013 | 1996-06-23 | 1997-06-23 |
|  10001 |  81025 | 1997-06-23 | 1998-06-23 |
|  10001 |  81097 | 1998-06-23 | 1999-06-23 |
|  10001 |  84917 | 1999-06-23 | 2000-06-22 |
|  10002 |  65828 | 1996-08-03 | 1997-08-03 |
|  10002 |  65909 | 1997-08-03 | 1998-08-03 |
|  10002 |  67534 | 1998-08-03 | 1999-08-03 |
|  10002 |  69366 | 1999-08-03 | 2000-08-02 |
|  10002 |  71963 | 2000-08-02 | 2001-08-02 |
|  10002 |  72527 | 2001-08-02 | 9999-01-01 |
|  10003 |  40006 | 1995-12-03 | 1996-12-02 |
|  10003 |  43616 | 1996-12-02 | 1997-12-02 |
|  10003 |  43311 | 2001-12-01 | 9999-01-01 |
|  10004 |  40054 | 1986-12-01 | 1987-12-01 |
|  10004 |  42283 | 1987-12-01 | 1988-11-30 |
|  10004 |  42542 | 1988-11-30 | 1989-11-30 |
|  10004 |  46065 | 1989-11-30 | 1990-11-30 |
|  10004 |  58326 | 1994-11-29 | 1995-11-29 |
|  10004 |  60770 | 1995-11-29 | 1996-11-28 |
|  10004 |  62566 | 1996-11-28 | 1997-11-28 |
|  10004 |  64340 | 1997-11-28 | 1998-11-28 |
|  10004 |  67096 | 1998-11-28 | 1999-11-28 |
|  10004 |  69722 | 1999-11-28 | 2000-11-27 |
|  10004 |  70698 | 2000-11-27 | 2001-11-27 |
|  10004 |  74057 | 2001-11-27 | 9999-01-01 |
|  10005 |  78228 | 1989-09-12 | 1990-09-12 |
|  10005 |  82621 | 1990-09-12 | 1991-09-12 |
|  10005 |  88063 | 1996-09-10 | 1997-09-10 |
|  10005 |  89724 | 1997-09-10 | 1998-09-10 |
|  10005 |  90392 | 1998-09-10 | 1999-09-10 |
|  10005 |  90531 | 1999-09-10 | 2000-09-09 |
|  10005 |  91453 | 2000-09-09 | 2001-09-09 |
|  10005 |  94692 | 2001-09-09 | 9999-01-01 |
|  10006 |  40000 | 1990-08-05 | 1991-08-05 |
|  10006 |  42085 | 1991-08-05 | 1992-08-04 |
|  10006 |  42629 | 1992-08-04 | 1993-08-04 |
|  10006 |  45844 | 1993-08-04 | 1994-08-04 |
|  10006 |  47518 | 1994-08-04 | 1995-08-04 |
|  10006 |  47917 | 1995-08-04 | 1996-08-03 |
|  10006 |  52255 | 1996-08-03 | 1997-08-03 |
|  10006 |  53747 | 1997-08-03 | 1998-08-03 |
|  10007 |  62745 | 1991-02-10 | 1992-02-10 |
|  10007 |  63475 | 1992-02-10 | 1993-02-09 |
|  10007 |  63208 | 1993-02-09 | 1994-02-09 |
|  10007 |  64563 | 1994-02-09 | 1995-02-09 |
+--------+--------+------------+------------+
+-------------+
| min(salary) |
+-------------+
|       40000 |
+-------------+
