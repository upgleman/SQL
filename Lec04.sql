-- [실습1] 데이터 그룹 짓기 - Group By 1

-- rental테이블의 구조를 조회합니다. 수정하실 필요는 없습니다.
DESC rental;

-- 누가 몇권의 책을 빌려갔는지 조회해 봅시다.


select user_id, count(*) from rental
group by user_id;

+-------------------+-------------+------+-----+---------+-------+
| Field             | Type        | Null | Key | Default | Extra |
+-------------------+-------------+------+-----+---------+-------+
| id                | int(11)     | NO   | PRI | NULL    |       |
| book_id           | varchar(32) | NO   | MUL | NULL    |       |
| user_id           | int(11)     | NO   | MUL | NULL    |       |
| rental_begin_date | datetime    | YES  |     | NULL    |       |
| rental_end_date   | datetime    | YES  |     | NULL    |       |
+-------------------+-------------+------+-----+---------+-------+
+---------+----------+
| user_id | count(*) |
+---------+----------+
|    1000 |        4 |
|    1001 |        2 |
|    1002 |        3 |
|    1003 |        1 |
+---------+----------+

-- [실습2] 데이터 그룹 짓기 - Group By 2

-- salaries 테이블에서 emp_no과 직원별로 연봉을 받은 횟수를 조회해보세요.

select emp_no, count(*) from salaries
group by emp_no;

+--------+----------+
| emp_no | count(*) |
+--------+----------+
|  10001 |       17 |
|  10002 |        6 |
|  10003 |        7 |
|  10004 |       16 |
|  10005 |       13 |
+--------+----------+

-- [실습3] 데이터 그룹에 조건 적용하기 - HAVING 1

-- rental테이블의 구조를 조회합니다. 수정하실 필요는 없습니다.
DESC rental;


-- 누가 몇권의 책을 빌려갔는지 조회해 봅시다.
-- 이때 두권 이상 빌린 사람들만 조회해 봅시다.

select user_id, count(*) from rental
group by user_id having user_id >=2;

+-------------------+-------------+------+-----+---------+-------+
| Field             | Type        | Null | Key | Default | Extra |
+-------------------+-------------+------+-----+---------+-------+
| id                | int(11)     | NO   | PRI | NULL    |       |
| book_id           | varchar(32) | NO   | MUL | NULL    |       |
| user_id           | int(11)     | NO   | MUL | NULL    |       |
| rental_begin_date | datetime    | YES  |     | NULL    |       |
| rental_end_date   | datetime    | YES  |     | NULL    |       |
+-------------------+-------------+------+-----+---------+-------+
+---------+----------+
| user_id | count(*) |
+---------+----------+
|    1000 |        4 |
|    1001 |        3 |
|    1002 |        3 |
+---------+----------+

-- [실습4] 데이터 그룹에 조건 적용하기 - HAVING 2

-- salaries 테이블에서 emp_no과 직원별로 연봉을 받은 횟수를 조회하되 연봉을 10번 이상 받은 직원만 조회해보세요.
DESC salaries;

select emp_no, count(*) from salaries
group by emp_no having count(salary) >=10;

+--------+----------+
| emp_no | count(*) |
+--------+----------+
|  10001 |       17 |
|  10004 |       16 |
|  10005 |       13 |
|  10006 |       12 |
|  10007 |       14 |
|  10009 |       18 |
+--------+----------+

-- [실습5] 두 테이블 간의 교집합 - INNER JOIN 1

-- 대출,반납에 대한 정보를 user 테이블과 연결해 조회해 봅시다.
select * from rental;
select * from user;

select * from rental
inner join user;

+------+---------+---------+---------------------+---------------------+
| id   | book_id | user_id | rental_begin_date   | rental_end_date     |
+------+---------+---------+---------------------+---------------------+
| 1000 |    1000 |    1000 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 |
| 1001 |    1001 |    1000 | 2018-11-02 10:20:00 | 2018-11-05 10:30:00 |
| 1002 |    1000 |    1001 | 2018-11-02 11:00:00 | 2018-11-04 12:00:00 |
| 1003 |    1006 |    1000 | 2018-11-10 18:00:00 | 2018-11-13 16:00:00 |
| 1004 |    1009 |    1010 | 2018-11-16 15:40:00 | 2018-11-23 10:30:00 |
| 1005 |    1002 |    1001 | 2018-12-01 09:00:00 | 2018-12-13 10:30:00 |
| 1006 |    1003 |    1011 | 2018-12-15 13:15:00 | 2019-01-01 09:00:00 |
| 1007 |    1004 |    1012 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 |
| 1008 |    1006 |    1002 | 2019-01-02 14:00:00 | 2019-01-03 11:30:00 |
| 1009 |    1006 |    1002 | 2019-02-01 14:00:00 | 2019-02-04 13:10:00 |
+------+---------+---------+---------------------+---------------------+
+------+-------------+-----------------------+---------------+------------------+
| id   | name        | email                 | phone         | address          |
+------+-------------+-----------------------+---------------+------------------+
| 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
| 1004 | Hatter      | hatter@elice.com      | 010-1357-2468 | 103-34 CeileDong |
+------+-------------+-----------------------+---------------+------------------+
+------+---------+---------+---------------------+---------------------+------+-------------+-----------------------+---------------+------------------+
| id   | book_id | user_id | rental_begin_date   | rental_end_date     | id   | name        | email                 | phone         | address          |
+------+---------+---------+---------------------+---------------------+------+-------------+-----------------------+---------------+------------------+
| 1000 |    1000 |    1000 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1000 |    1000 |    1000 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1000 |    1000 |    1000 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1000 |    1000 |    1000 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
| 1000 |    1000 |    1000 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1004 | Hatter      | hatter@elice.com      | 010-1357-2468 | 103-34 CeileDong |
| 1001 |    1001 |    1000 | 2018-11-02 10:20:00 | 2018-11-05 10:30:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1001 |    1001 |    1000 | 2018-11-02 10:20:00 | 2018-11-05 10:30:00 | 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1001 |    1001 |    1000 | 2018-11-02 10:20:00 | 2018-11-05 10:30:00 | 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1001 |    1001 |    1000 | 2018-11-02 10:20:00 | 2018-11-05 10:30:00 | 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
| 1001 |    1001 |    1000 | 2018-11-02 10:20:00 | 2018-11-05 10:30:00 | 1004 | Hatter      | hatter@elice.com      | 010-1357-2468 | 103-34 CeileDong |
| 1002 |    1000 |    1001 | 2018-11-02 11:00:00 | 2018-11-04 12:00:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1002 |    1000 |    1001 | 2018-11-02 11:00:00 | 2018-11-04 12:00:00 | 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1002 |    1000 |    1001 | 2018-11-02 11:00:00 | 2018-11-04 12:00:00 | 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1002 |    1000 |    1001 | 2018-11-02 11:00:00 | 2018-11-04 12:00:00 | 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
| 1002 |    1000 |    1001 | 2018-11-02 11:00:00 | 2018-11-04 12:00:00 | 1004 | Hatter      | hatter@elice.com      | 010-1357-2468 | 103-34 CeileDong |
| 1003 |    1006 |    1000 | 2018-11-10 18:00:00 | 2018-11-13 16:00:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1003 |    1006 |    1000 | 2018-11-10 18:00:00 | 2018-11-13 16:00:00 | 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1003 |    1006 |    1000 | 2018-11-10 18:00:00 | 2018-11-13 16:00:00 | 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1003 |    1006 |    1000 | 2018-11-10 18:00:00 | 2018-11-13 16:00:00 | 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
| 1003 |    1006 |    1000 | 2018-11-10 18:00:00 | 2018-11-13 16:00:00 | 1004 | Hatter      | hatter@elice.com      | 010-1357-2468 | 103-34 CeileDong |
| 1004 |    1009 |    1010 | 2018-11-16 15:40:00 | 2018-11-23 10:30:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1004 |    1009 |    1010 | 2018-11-16 15:40:00 | 2018-11-23 10:30:00 | 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1004 |    1009 |    1010 | 2018-11-16 15:40:00 | 2018-11-23 10:30:00 | 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1004 |    1009 |    1010 | 2018-11-16 15:40:00 | 2018-11-23 10:30:00 | 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
| 1004 |    1009 |    1010 | 2018-11-16 15:40:00 | 2018-11-23 10:30:00 | 1004 | Hatter      | hatter@elice.com      | 010-1357-2468 | 103-34 CeileDong |
| 1005 |    1002 |    1001 | 2018-12-01 09:00:00 | 2018-12-13 10:30:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1005 |    1002 |    1001 | 2018-12-01 09:00:00 | 2018-12-13 10:30:00 | 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1005 |    1002 |    1001 | 2018-12-01 09:00:00 | 2018-12-13 10:30:00 | 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1005 |    1002 |    1001 | 2018-12-01 09:00:00 | 2018-12-13 10:30:00 | 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
| 1005 |    1002 |    1001 | 2018-12-01 09:00:00 | 2018-12-13 10:30:00 | 1004 | Hatter      | hatter@elice.com      | 010-1357-2468 | 103-34 CeileDong |
| 1006 |    1003 |    1011 | 2018-12-15 13:15:00 | 2019-01-01 09:00:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1006 |    1003 |    1011 | 2018-12-15 13:15:00 | 2019-01-01 09:00:00 | 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1006 |    1003 |    1011 | 2018-12-15 13:15:00 | 2019-01-01 09:00:00 | 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1006 |    1003 |    1011 | 2018-12-15 13:15:00 | 2019-01-01 09:00:00 | 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
| 1006 |    1003 |    1011 | 2018-12-15 13:15:00 | 2019-01-01 09:00:00 | 1004 | Hatter      | hatter@elice.com      | 010-1357-2468 | 103-34 CeileDong |
| 1007 |    1004 |    1012 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1007 |    1004 |    1012 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1007 |    1004 |    1012 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1007 |    1004 |    1012 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
| 1007 |    1004 |    1012 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1004 | Hatter      | hatter@elice.com      | 010-1357-2468 | 103-34 CeileDong |
| 1008 |    1006 |    1002 | 2019-01-02 14:00:00 | 2019-01-03 11:30:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1008 |    1006 |    1002 | 2019-01-02 14:00:00 | 2019-01-03 11:30:00 | 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1008 |    1006 |    1002 | 2019-01-02 14:00:00 | 2019-01-03 11:30:00 | 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1008 |    1006 |    1002 | 2019-01-02 14:00:00 | 2019-01-03 11:30:00 | 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
| 1008 |    1006 |    1002 | 2019-01-02 14:00:00 | 2019-01-03 11:30:00 | 1004 | Hatter      | hatter@elice.com      | 010-1357-2468 | 103-34 CeileDong |
| 1009 |    1006 |    1002 | 2019-02-01 14:00:00 | 2019-02-04 13:10:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1009 |    1006 |    1002 | 2019-02-01 14:00:00 | 2019-02-04 13:10:00 | 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1009 |    1006 |    1002 | 2019-02-01 14:00:00 | 2019-02-04 13:10:00 | 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1009 |    1006 |    1002 | 2019-02-01 14:00:00 | 2019-02-04 13:10:00 | 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
| 1009 |    1006 |    1002 | 2019-02-01 14:00:00 | 2019-02-04 13:10:00 | 1004 | Hatter      | hatter@elice.com      | 010-1357-2468 | 103-34 CeileDong |
+------+---------+---------+---------------------+---------------------+------+-------------+-----------------------+---------------+------------------+

-- [실습6] 두 테이블 간의 교집합 - INNER JOIN 2

-- 대출,반납에 대한 정보를 user 테이블과 연결해 조회해 봅시다.
select * from rental
inner join user
on user.id = rental.user_id;

+------+---------+---------+---------------------+---------------------+------+----------+--------------------+---------------+------------------+
| id   | book_id | user_id | rental_begin_date   | rental_end_date     | id   | name     | email              | phone         | address          |
+------+---------+---------+---------------------+---------------------+------+----------+--------------------+---------------+------------------+
| 1000 |    1000 |    1000 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1000 | Elice    | elice@elice.com    | 010-1234-5678 | 101-23 CeileDong |
| 1001 |    1001 |    1000 | 2018-11-02 10:20:00 | 2018-11-05 10:30:00 | 1000 | Elice    | elice@elice.com    | 010-1234-5678 | 101-23 CeileDong |
| 1003 |    1006 |    1000 | 2018-11-10 18:00:00 | 2018-11-13 16:00:00 | 1000 | Elice    | elice@elice.com    | 010-1234-5678 | 101-23 CeileDong |
| 1002 |    1000 |    1001 | 2018-11-02 11:00:00 | 2018-11-04 12:00:00 | 1001 | Cheshire | cheshire@elice.com | 010-8765-4321 | 101-24 CeileDong |
| 1005 |    1002 |    1001 | 2018-12-01 09:00:00 | 2018-12-13 10:30:00 | 1001 | Cheshire | cheshire@elice.com | 010-8765-4321 | 101-24 CeileDong |
| 1008 |    1006 |    1002 | 2019-01-02 14:00:00 | 2019-01-03 11:30:00 | 1002 | Dodo     | dodo@elice.com     | 010-1111-2222 | 100-11 CeileDong |
| 1009 |    1006 |    1002 | 2019-02-01 14:00:00 | 2019-02-04 13:10:00 | 1002 | Dodo     | dodo@elice.com     | 010-1111-2222 | 100-11 CeileDong |
+------+---------+---------+---------------------+---------------------+------+----------+--------------------+---------------+------------------+

-- [실습7] 두 테이블 간의 교집합 - INNER JOIN 3

-- 연봉에 대한 정보를 employees 테이블과 연결해 조회해 봅시다.
select * from salaries
inner join employees
on salaries.emp_no = employees.emp_no;

+--------+--------+------------+------------+--------+------------+------------+-----------+--------+------------+-------------+
| emp_no | salary | from_date  | to_date    | emp_no | birth_date | first_name | last_name | gender | hire_date  | superior_no |
+--------+--------+------------+------------+--------+------------+------------+-----------+--------+------------+-------------+
|  10001 |  60117 | 1986-06-26 | 1987-06-26 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  62102 | 1987-06-26 | 1988-06-25 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  66074 | 1988-06-25 | 1989-06-25 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  66596 | 1989-06-25 | 1990-06-25 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  66961 | 1990-06-25 | 1991-06-25 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  71046 | 1991-06-25 | 1992-06-24 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  74333 | 1992-06-24 | 1993-06-24 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  75286 | 1993-06-24 | 1994-06-24 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  75994 | 1994-06-24 | 1995-06-24 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  76884 | 1995-06-24 | 1996-06-23 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  80013 | 1996-06-23 | 1997-06-23 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  81025 | 1997-06-23 | 1998-06-23 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  81097 | 1998-06-23 | 1999-06-23 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  84917 | 1999-06-23 | 2000-06-22 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  85112 | 2000-06-22 | 2001-06-22 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  85097 | 2001-06-22 | 2002-06-22 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  88958 | 2002-06-22 | 9999-01-01 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10002 |  65828 | 1996-08-03 | 1997-08-03 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  65909 | 1997-08-03 | 1998-08-03 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  67534 | 1998-08-03 | 1999-08-03 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  69366 | 1999-08-03 | 2000-08-02 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  71963 | 2000-08-02 | 2001-08-02 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  72527 | 2001-08-02 | 9999-01-01 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10003 |  40006 | 1995-12-03 | 1996-12-02 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43616 | 1996-12-02 | 1997-12-02 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43466 | 1997-12-02 | 1998-12-02 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43636 | 1998-12-02 | 1999-12-02 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43478 | 1999-12-02 | 2000-12-01 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43699 | 2000-12-01 | 2001-12-01 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43311 | 2001-12-01 | 2001-12-01 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
+--------+--------+------------+------------+--------+------------+------------+-----------+--------+------------+-------------+

-- [실습8] 왼쪽 테이블의 모든 값과 교집합 - LEFT JOIN 1

-- 대출,반납에 대한 정보를 user 테이블과 연결해 조회해 봅시다.
-- 대신 rental 테이블이 중심이 되도록 조회해 봅시다.

select * from rental
left join user
on user.id = rental.user_id;

+------+---------+---------+---------------------+---------------------+------+----------+--------------------+---------------+------------------+
| id   | book_id | user_id | rental_begin_date   | rental_end_date     | id   | name     | email              | phone         | address          |
+------+---------+---------+---------------------+---------------------+------+----------+--------------------+---------------+------------------+
| 1000 |    1000 |    1000 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1000 | Elice    | elice@elice.com    | 010-1234-5678 | 101-23 CeileDong |
| 1001 |    1001 |    1000 | 2018-11-02 10:20:00 | 2018-11-05 10:30:00 | 1000 | Elice    | elice@elice.com    | 010-1234-5678 | 101-23 CeileDong |
| 1002 |    1000 |    1001 | 2018-11-02 11:00:00 | 2018-11-04 12:00:00 | 1001 | Cheshire | cheshire@elice.com | 010-8765-4321 | 101-24 CeileDong |
| 1003 |    1006 |    1000 | 2018-11-10 18:00:00 | 2018-11-13 16:00:00 | 1000 | Elice    | elice@elice.com    | 010-1234-5678 | 101-23 CeileDong |
| 1004 |    1009 |    1010 | 2018-11-16 15:40:00 | 2018-11-23 10:30:00 | NULL | NULL     | NULL               | NULL          | NULL             |
| 1005 |    1002 |    1001 | 2018-12-01 09:00:00 | 2018-12-13 10:30:00 | 1001 | Cheshire | cheshire@elice.com | 010-8765-4321 | 101-24 CeileDong |
| 1006 |    1003 |    1011 | 2018-12-15 13:15:00 | 2019-01-01 09:00:00 | NULL | NULL     | NULL               | NULL          | NULL             |
| 1007 |    1004 |    1012 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | NULL | NULL     | NULL               | NULL          | NULL             |
| 1008 |    1006 |    1002 | 2019-01-02 14:00:00 | 2019-01-03 11:30:00 | 1002 | Dodo     | dodo@elice.com     | 010-1111-2222 | 100-11 CeileDong |
| 1009 |    1006 |    1002 | 2019-02-01 14:00:00 | 2019-02-04 13:10:00 | 1002 | Dodo     | dodo@elice.com     | 010-1111-2222 | 100-11 CeileDong |
+------+---------+---------+---------------------+---------------------+------+----------+--------------------+---------------+------------------+

-- [실습9] 왼쪽 테이블의 모든 값과 교집합 - LEFT JOIN 2

-- 연봉에 대한 정보를 employees 테이블과 연결해 조회하되 salaries 테이블을 중심으로 조회해보세요.
select * from salaries
left join employees
on salaries.emp_no = employees.emp_no;

+--------+--------+------------+------------+--------+------------+------------+-----------+--------+------------+-------------+
| emp_no | salary | from_date  | to_date    | emp_no | birth_date | first_name | last_name | gender | hire_date  | superior_no |
+--------+--------+------------+------------+--------+------------+------------+-----------+--------+------------+-------------+
|  10001 |  60117 | 1986-06-26 | 1987-06-26 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  62102 | 1987-06-26 | 1988-06-25 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  66074 | 1988-06-25 | 1989-06-25 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  66596 | 1989-06-25 | 1990-06-25 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  66961 | 1990-06-25 | 1991-06-25 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  71046 | 1991-06-25 | 1992-06-24 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  74333 | 1992-06-24 | 1993-06-24 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  75286 | 1993-06-24 | 1994-06-24 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  75994 | 1994-06-24 | 1995-06-24 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  76884 | 1995-06-24 | 1996-06-23 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  80013 | 1996-06-23 | 1997-06-23 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  81025 | 1997-06-23 | 1998-06-23 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  81097 | 1998-06-23 | 1999-06-23 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  84917 | 1999-06-23 | 2000-06-22 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  85112 | 2000-06-22 | 2001-06-22 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  85097 | 2001-06-22 | 2002-06-22 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  88958 | 2002-06-22 | 9999-01-01 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10002 |  65828 | 1996-08-03 | 1997-08-03 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  65909 | 1997-08-03 | 1998-08-03 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  67534 | 1998-08-03 | 1999-08-03 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  69366 | 1999-08-03 | 2000-08-02 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  71963 | 2000-08-02 | 2001-08-02 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  72527 | 2001-08-02 | 9999-01-01 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10003 |  40006 | 1995-12-03 | 1996-12-02 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43616 | 1996-12-02 | 1997-12-02 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43466 | 1997-12-02 | 1998-12-02 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43636 | 1998-12-02 | 1999-12-02 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43478 | 1999-12-02 | 2000-12-01 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43699 | 2000-12-01 | 2001-12-01 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43311 | 2001-12-01 | 2001-12-01 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10004 |  40054 | 1986-12-01 | 1987-12-01 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  42283 | 1987-12-01 | 1988-11-30 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  42542 | 1988-11-30 | 1989-11-30 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  46065 | 1989-11-30 | 1990-11-30 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  48271 | 1990-11-30 | 1991-11-30 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  50594 | 1991-11-30 | 1992-11-29 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  52119 | 1992-11-29 | 1993-11-29 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  54693 | 1993-11-29 | 1994-11-29 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  58326 | 1994-11-29 | 1995-11-29 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  60770 | 1995-11-29 | 1996-11-28 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  62566 | 1996-11-28 | 1997-11-28 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  64340 | 1997-11-28 | 1998-11-28 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  67096 | 1998-11-28 | 1999-11-28 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  69722 | 1999-11-28 | 2000-11-27 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  70698 | 2000-11-27 | 2001-11-27 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
|  10004 |  74057 | 2001-11-27 | 2002-11-27 |   NULL | NULL       | NULL       | NULL      | NULL   | NULL       |        NULL |
+--------+--------+------------+------------+--------+------------+------------+-----------+--------+------------+-------------+

-- [실습10] 오른쪽 테이블의 모든 값과 교집합 - RIGHT JOIN 1

-- 대출,반납에 대한 정보를 user 테이블과 연결해 조회해 봅시다.
-- 대신 user테이블이 중심이 되도록 해 봅시다.

select * from rental
right join user
on user.id = rental.user_id;

+------+---------+---------+---------------------+---------------------+------+-------------+-----------------------+---------------+------------------+
| id   | book_id | user_id | rental_begin_date   | rental_end_date     | id   | name        | email                 | phone         | address          |
+------+---------+---------+---------------------+---------------------+------+-------------+-----------------------+---------------+------------------+
| 1000 |    1000 |    1000 | 2018-10-30 15:30:00 | 2018-10-31 13:00:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1001 |    1001 |    1000 | 2018-11-02 10:20:00 | 2018-11-05 10:30:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1002 |    1000 |    1001 | 2018-11-02 11:00:00 | 2018-11-04 12:00:00 | 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1003 |    1006 |    1000 | 2018-11-10 18:00:00 | 2018-11-13 16:00:00 | 1000 | Elice       | elice@elice.com       | 010-1234-5678 | 101-23 CeileDong |
| 1005 |    1002 |    1001 | 2018-12-01 09:00:00 | 2018-12-13 10:30:00 | 1001 | Cheshire    | cheshire@elice.com    | 010-8765-4321 | 101-24 CeileDong |
| 1008 |    1006 |    1002 | 2019-01-02 14:00:00 | 2019-01-03 11:30:00 | 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| 1009 |    1006 |    1002 | 2019-02-01 14:00:00 | 2019-02-04 13:10:00 | 1002 | Dodo        | dodo@elice.com        | 010-1111-2222 | 100-11 CeileDong |
| NULL |    NULL |    NULL | NULL                | NULL                | 1003 | Caterpillar | caterpillar@elice.com | 010-1212-3434 | 100-12 CeileDong |
| NULL |    NULL |    NULL | NULL                | NULL                | 1004 | Hatter      | hatter@elice.com      | 010-1357-2468 | 103-34 CeileDong |
+------+---------+---------+---------------------+---------------------+------+-------------+-----------------------+---------------+------------------+

-- [실습11] 오른쪽 테이블의 모든 값과 교집합 - RIGHT JOIN 2

-- 연봉에 대한 정보를 employees 테이블과 연결해 조회하되 employees 테이블을 중심으로 조회해보세요.
select * from salaries
right join employees
on salaries.emp_no = employees.emp_no;

+--------+--------+------------+------------+--------+------------+------------+-----------+--------+------------+-------------+
| emp_no | salary | from_date  | to_date    | emp_no | birth_date | first_name | last_name | gender | hire_date  | superior_no |
+--------+--------+------------+------------+--------+------------+------------+-----------+--------+------------+-------------+
|  10001 |  60117 | 1986-06-26 | 1987-06-26 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  62102 | 1987-06-26 | 1988-06-25 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  66074 | 1988-06-25 | 1989-06-25 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  66596 | 1989-06-25 | 1990-06-25 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  66961 | 1990-06-25 | 1991-06-25 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  71046 | 1991-06-25 | 1992-06-24 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  74333 | 1992-06-24 | 1993-06-24 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  75286 | 1993-06-24 | 1994-06-24 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  75994 | 1994-06-24 | 1995-06-24 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  76884 | 1995-06-24 | 1996-06-23 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  80013 | 1996-06-23 | 1997-06-23 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  81025 | 1997-06-23 | 1998-06-23 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  81097 | 1998-06-23 | 1999-06-23 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  84917 | 1999-06-23 | 2000-06-22 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  85112 | 2000-06-22 | 2001-06-22 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  85097 | 2001-06-22 | 2002-06-22 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10001 |  88958 | 2002-06-22 | 9999-01-01 |  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |       10002 |
|  10002 |  65828 | 1996-08-03 | 1997-08-03 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  65909 | 1997-08-03 | 1998-08-03 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  67534 | 1998-08-03 | 1999-08-03 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  69366 | 1999-08-03 | 2000-08-02 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  71963 | 2000-08-02 | 2001-08-02 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10002 |  72527 | 2001-08-02 | 9999-01-01 |  10002 | 1964-06-02 | Bezalel    | Simmel    | F      | 1985-11-21 |        NULL |
|  10003 |  40006 | 1995-12-03 | 1996-12-02 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43616 | 1996-12-02 | 1997-12-02 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43466 | 1997-12-02 | 1998-12-02 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43636 | 1998-12-02 | 1999-12-02 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43478 | 1999-12-02 | 2000-12-01 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43699 | 2000-12-01 | 2001-12-01 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|  10003 |  43311 | 2001-12-01 | 2001-12-01 |  10003 | 1959-12-03 | Parto      | Bamford   | M      | 1986-08-28 |       10002 |
|   NULL |   NULL | NULL       | NULL       |  10005 | 1955-01-21 | Kyoichi    | Maliniak  | M      | 1989-09-12 |       10003 |
+--------+--------+------------+------------+--------+------------+------------+-----------+--------+------------+-------------+

